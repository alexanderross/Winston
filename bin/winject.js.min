function EventWrapper(e,t){this.base=e;this.evt_data=t;this.nextEvt=undefined;this.prevEvt=undefined;this.toString=function(){};this.setNext=function(e){this.nextEvt=e;ext_obj.prevEvt=this};this.setPrev=function(e){this.prevEvt=e;ext_obj.nextEvt=this};this.surrender=function(){if(this.nextEvt!=undefined){this.nextEvt.prevEvt=undefined;return this.nextEvt}};this.addToTail=function(e){if(this.nextEvt!=undefined){this.nextEvt.addToTail(e);return}this.setNext(e)}}function WinDomAttrWrapper(e,t,n){this.attr_name=undefined;this.display_block=undefined;this.attr_states=[];this.parent_wrapper=undefined;this.toggle_active=function(e,t){this.attr_states[t][0]=!this.attr_states[t][0];e=this.display_block.find(".winston_attr_comp_wrap:eq("+t+")");if(this.attr_states[t][0]){e.addClass("winston_active_attr")}else{e.removeClass("winston_active_attr")}Winston.refreshActive(true)};this.renderWrapper=function(){if(this.display_block==undefined){this.display_block=DRRenderer.getNewExpanderAttr(this.attr_name)}var e=this;for(var t=0;t<this.attr_states.length;t++){(function(e,t){var n=DRRenderer.getNewExpanderAttrComp(t.attr_states[e][1]);t.display_block.append(n);DRRenderer.decorateAttrComp(n,t.attr_name);n.click(function(r){t.toggle_active(n,e)});if(t.attr_states[e][0])n.addClass("winston_active_attr")})(t,e)}return this.display_block};this.to_tag=function(){var e="";var t=DRRenderer.engine_executions[this.attr_name];if(t==undefined){t=DRRenderer.engine_executions["_default"].split("<>");if(t.length==3){t[0]=t[0]+this.attr_name+t[1];t[1]=t[2]}}else{t=t.split("<>")}for(var n=0;n<this.attr_states.length;n++){if(this.attr_states[n][0]){e+=t[0]+this.attr_states[n][1].replace(/([\'\"])/,"\\$1")+t[1]}}return e};this.instantiateWrapper=function(e,t,n){this.parent_wrapper=e;this.attr_name=t;if(t=="class"){var r=n.split(" ");for(var i=0;i<r.length;i++){this.attr_states.push([false,r[i]])}}else{this.attr_states.push([false,n])}};this.instantiateWrapper(e,t,n)}function WinDomWrapper(e,t,n){this.wrapper_id="STATIC";this.display_block=undefined;this.attr_tracker={};this.display_block=undefined;this.base=undefined;this.current_length=0;this.use_eq=false;this.renderWrapper=function(){if(this.display_block==undefined){this.display_block=DRRenderer.getNewDomExpander(this.base)}var e=this.display_block.find(".winston_expander_criteria");e.remove(".winston_criteria_sel");for(var t in this.attr_tracker){e.append(this.attr_tracker[t].renderWrapper())}var n=this;this.display_block.find(".winston_expander_toggle_parent").click(function(){n.addParent()});this.display_block.find(".winston_expander_toggle_eq").click(function(e){n.toggleIndexing(e)});this.refresh();return this.display_block};this.toggleIndexing=function(e){$(e.target).toggleClass("winston_expander_option_inactive");this.use_eq=!this.use_eq;this.refresh()};this.renderCount=function(e){var t=this.display_block.find(".winston_expander_count");t.html(this.current_length);if(Winston.selecting||this.current_length==1){t.addClass("winston_select_count_valid")}else{t.removeClass("winston_select_count_valid")}};this.addAttribute=function(e,t){this.attr_tracker[e]=new WinDomAttrWrapper(this,e,t)};this.instantiateWrapper=function(e,t,n){this.active_parent=t;this.passive_child=n;this.base=$(e);this.display_block=DRRenderer.getNewDomExpander(this.base);var r=WinstonSocket.opts["seek_attrs"];for(var i=0;i<r.length;i++){if(this.base.attr(r[i])!=undefined){var s=DRRenderer.deWinstonfy(this.base.attr(r[i]).toString());if(s!=""){this.addAttribute(r[i],s)}}}var o=DRRenderer.getValidLabel(this.base);if(o!=""){this.addAttribute("_label",o)}};this.indexWithinTag=function(e){var t=$(e).index(this.base);if(t!=-1){var n=DRRenderer.engine_executions["_eq"].split("<>");return n[0]+t.toString()+n[1]}};this.to_tag=function(){var e=this;var t="";if(e.active_parent!=undefined){t=e.active_parent.to_tag()+DRRenderer.windom_execution}t+=e.base[0].tagName;for(var n in e.attr_tracker){t+=e.attr_tracker[n].to_tag()}if(e.use_eq){t+=e.indexWithinTag(t)}return t};this.refresh=function(e){var t=$(DRRenderer.unbiasTag(this.to_tag()));$(".winstondom_matched_element").removeClass("winstondom_matched_element");console.log("IS LEN "+t.length.toString());this.current_length=t.length;t.addClass("winstondom_matched_element");this.renderCount();if(e&amp;&amp;this.active_parent!=undefined){this.active_parent.refresh(true)}};this.addParent=function(){if(this.active_parent!=undefined){this.active_parent.addParent();return}this.active_parent=new WinDomWrapper(this.base.parent(),undefined,this);this.display_block.before(this.active_parent.renderWrapper());this.refresh(false)};this.toParent=function(){if(this.base.children().length!=0)this.instantiateWrapper(this.base.firstChild()[0]);this.renderWrapper()};this.toFirstChild=function(){if(this.base.children().length!=0)this.instantiateWrapper(this.base.firstChild()[0]);this.renderWrapper()};this.toRight=function(){if(this.base.next().length!=0)this.instantiateWrapper(this.base.next()[0],this.active_parent);this.renderWrapper()};this.toLeft=function(){if(this.base.prev().length!=0)this.instantiateWrapper(this.base.prev()[0],this.active_parent);this.renderWrapper()};this.instantiateWrapper(e,t,n)}var rush_those_listeners=true;var WinstonSocket={current_event_id:0,sendEvent:function(e){chrome.extension.sendMessage(e)},queueEvent:function(e,t,n){},loadTemplate:function(e){},opts:{seek_attrs:["class","id","value","_label"]}};var winston_renders=undefined;var DRRenderer={presentations:{"class":".<>",id:"#<>",_label:"<>",_eq:":eq(<>)",_default:"[<>='<>']"},engine_executions:{"class":".<>",id:"#<>",_label:":contains('<>')",_eq:":eq(<>)",_default:"[<>='<>']"},negation:":not(<>)",windom_execution:" ",unbiasTag:function(e){var t=e;var n=DRRenderer.negation.split("<>");t+=n[0];t+="[id^='winston_'],[class^='winston_']";t+=n[1];console.log("UNBIAS => "+t);return t},deWinstonfy:function(e){return $.trim(e.replace(/winstondom_\S+/g,""))},getValidLabel:function(e){e=e[0];var t="";if(e){var t="";for(var n=0;n<e.childNodes.length;n++){if(e.childNodes[n].tagName==undefined){t+=e.childNodes[n].data}}return t}return""},truncateStr:function(e,t){var n=e;if(e.length>t){var r=Math.floor(t/2)-2;n=n.substr(0,r)+" .. "+n.substr(n.length-r)}return n},decorateAttrComp:function(e,t){var n=DRRenderer.presentations[t];if(n==undefined){n=DRRenderer.presentations["_default"].split("<>");if(n.length==3){n[0]=n[0]+t+n[1];n[1]=n[2]}}else{n=n.split("<>")}if(n[0]!="")e.find(".wad_head").html(n[0]);if(n[1]!="")e.find(".wad_tail").html(n[1]);return e},getNewBase:function(e){var t=winston_renders["main"];return $(DRRenderer.prepTemplateWithWildcards(t,[]))},getNewDomExpander:function(e){var t=winston_renders["expander"];var n=[["dom_tag",e[0].tagName]];return $(DRRenderer.prepTemplateWithWildcards(t,n))},getNewExpanderAttrComp:function(e){var t=winston_renders["expander_attr_comp"];return $(DRRenderer.prepTemplateWithWildcards(t,[["atr_value",DRRenderer.truncateStr(e,16)]]))},getNewExpanderAttr:function(e){var t=winston_renders["expander_attr"];return $(DRRenderer.prepTemplateWithWildcards(t,[["type",e]]))},getExpanderAttrDelimiter:function(e){return DRRenderer.delimiters[e]},prepTemplateWithWildcards:function(e,t){for(var n=0;n<t.length;n++){e=e.replace(new RegExp("@"+t[n][0]+"@","g"),t[n][1])}return e}};var Winston={loaded:false,use_dom_keys:false,do_kill:false,lock_ajax:false,page_listeners_loaded:false,base_loaded:false,display_block:undefined,sel_mode:0,active_expander:undefined,active_deferred_event:undefined,event_active:false,destroyAll:function(){$(document).unbind(".winston");Winston.destroyCurrentExpander();Winston.destroyPageListeners();Winston.destroyWinstonBaseListeners();Winston.destroyDomTraversalKeys();Winston.destroySelectEventListeners();$("*").unbind(".winston");$("body").children("#winston_box").fadeOut(500).remove();Winston.loaded=false},loadAll:function(e){if(Winston.loaded)return;if(winston_renders==undefined){console.log("Warning :: render templates not defined at load time. Is the base broken??");return}if(e==true||e==undefined){this.display_block=DRRenderer.getNewBase();$("body").append(this.display_block)}this.loadPageListeners();this.loadWinstonBaseListeners();Winston.loaded=true},loadWrapper:function(e){if(e==undefined)return;if(this.active_expander!=undefined){Winston.destroyCurrentExpander()}$(document.getElementById("winston_kill_current")).removeClass("winston_item_hidden");$(document.getElementById("winston_AEC")).removeClass("winston_item_hidden");this.sel_mode=1;this.active_expander=e;this.active_expander.base.addClass("winstondom_selected_dom_element");this.display_block.find("#winston_expand_container").append(e.renderWrapper())},loadObject:function(e){if(e==undefined)return;if(e.tagName==undefined)return;Winston.loadWrapper(new WinDomWrapper(e))},loadEvent:function(e){Winston.loadObject(e)},destroyCurrentExpander:function(){if(this.display_block==undefined)return;this.display_block.find(".winston_expander").remove();$(".winstondom_selected_dom_element").removeClass("winstondom_selected_dom_element");$(document.getElementById("winston_kill_current")).addClass("winston_item_hidden");$(document.getElementById("winston_AEC")).addClass("winston_item_hidden");$(".winstondom_matched_element").removeClass("winstondom_matched_element");this.active_expander=undefined;this.sel_mode=0},toggleDomKeys:function(){Winston.use_dom_keys=!Winston.use_dom_keys;var e=$(document.getElementById("winston_keys"));if(Winston.use_dom_keys){e.addClass("winston_base_option_active");Winston.loadDomTraversalKeys()}else{e.removeClass("winston_base_option_active");Winston.destroyDomTraversalKeys()}},activateHead:function(){Winston.loadObject(Winston.active_deferred_event.base);Winston.event_active=true},deleteHead:function(){Winston.active_deferred_event=Winston.active_deferred_event.surrender()},queueEvent:function(e){if(Winston.active_deferred_event!=undefined){Winston.active_deferred_event.addToTail(e)}else{Winston.active_deferred_event=e}if(Winston.active_expander==undefined){Winston.activateHead()}},loadPageListeners:function(){$(document).on("blur.winston",function(){WinstonSocket.sendEvent({action:"FieldBlur",target:this.name,value:$(this).val()})});$(document).on("change.winston",'input[type="file"]',function(e){WinstonSocket.sendEvent({action:"FileUpload",target:this.name,value:$(this).val()})});$(document).on("change.winston",function(){if($(this).is(":checked")){WinstonSocket.sendEvent({action:"CheckboxCheck",target:object.name,value:$(object).val()})}else{WinstonSocket.sendEvent({action:"CheckboxUnCheck",target:object.name,value:$(object).val()})}});$(document).on("change.winston",function(){var e=$(object).find("option:selected").html();WinstonSocket.sendEvent({action:"SelectChange",target:this.name,value:e})});$(document).on("submit.winston",function(e){});$(document).on("click.winston","input:submit",function(){if(!selecting){var e=this;if(allowLabelClick){WinstonSocket.sendEvent({action:"SubmitClick",target:e.name,value:$(e).val()});return true}else{return fullProcessClickedObject(e)}}else{return false}});$(document).on("click.winston",function(e){var t=e.target;$(t).removeClass("winston_hover");if(t.className.indexOf("winston_")==-1&amp;&amp;t.id.indexOf("winston_")==-1&amp;&amp;Winston.sel_mode==0){Winston.loadObject(e.target);e.stopPropagation();e.preventDefault();Winston.sel_mode=1;return false}});Winston.page_listeners_loaded=true},destroyPageListeners:function(){$(document).unbind(".winston");Winston.page_listeners_loaded=false},loadWinstonBaseListeners:function(){Winston.lock_ajax=true;var e=$(document.getElementById("winston_box"));e.on("click.winstoncr","#winston_base_back",function(){WinstonSocket.sendEvent({action:"Winston",target:"undo"});return false});e.on("click.winstoncr","#winston_base_forward",function(){WinstonSocket.sendEvent({action:"Winston",target:"redo"});return false});e.on("click.winstoncr","#winston_kill",function(){WinstonSocket.sendEvent({action:"Winston",target:"kill"});return false});e.on("click.winstoncr","#winston_base_pause",function(){paused=!paused;if(paused){destroyListeners(false);$("b.winston_name").html("Winston[Paused]");$("b#winston_pause").html("▶")}else{loadListeners(false);$("b.winston_name").html("Winston");$("b#winston_pause").html("∎")}return false});e.on("click.winstoncr","#winston_kill_current",function(){Winston.destroyCurrentExpander()});e.on("click.winstoncr","#winston_AEC",function(){Winston.sel_mode=2;Winston.confirmCurrentState()});e.on("click.winstoncr","#winston_select",function(){if(selecting){disableSelectMode();setHeaderMsg("notify","Canceled Element Selection")}return false});e.on("click.winstoncr","#winston_keys",function(){Winston.toggleDomKeys()});e.on("click.winstoncr",".winston_select_count.winston_select_count_valid",function(){Winston.confirmCurrentState()});console.log("Winston: Base Loaded");Winston.base_loaded=true;Winston.lock_ajax=false},destroyWinstonBaseListeners:function(){$("*").unbind(".winstoncr");Winston.base_loaded=false},loadSelectEventListeners:function(){Winston.sel_evts_loaded=false},destroySelectEventListeners:function(){$("*").unbind(".winstonsel");Winston.sel_evts_loaded=false},loadDomTraversalKeys:function(){if(!Winston.use_dom_keys)return;$(document).on("keydown.winstondomkey",function(e){switch(e.keyCode){case 37:Winston.traverseLeft();break;case 38:Winston.traverseUpwards();break;case 39:Winston.traverseRight();break;case 40:Winston.traverseDownwards();break;case 13:Winston.confirmCurrentState();break;default:break}});Winston.dk_evts_loaded=true},destroyDomTraversalKeys:function(){$("*").unbind(".winstondomkey");Winston.dk_evts_loaded=false},selecting:false,startSelectSequence:function(){if(Winston.selecting)return;Winston.selecting=true;Winston.sel_mode=2;Winston.loadSelectEventListeners()},endSelectSequence:function(){Winston.selecting=false;Winston.sel_mode=0;Winston.destroySelectEventListeners()},gotoParentLevel:function(){this.active_expander=Winston.active_expander.activate_parent();this.active_expander.disownChild()},traverseLeft:function(){Winston.loadObject(Winston.active_expander.base.prev()[0])},traverseRight:function(){Winston.loadObject(Winston.active_expander.base.next()[0])},traverseUpwards:function(){Winston.loadObject(Winston.active_expander.base.parent()[0])},traverseDownwards:function(e,t){Winston.loadObject(Winston.active_expander.base[0].childNodes[0])},refreshActive:function(){Winston.active_expander.refresh(true)},setAttribute:function(e,t,n){},confirmCurrentState:function(){if(Winston.sel_mode==0){return}else if(Winston.sel_mode==1){if(Winston.active_expander.current_length==1){WinstonSocket.sendEvent({action:"ElementClick",target:Winston.active_expander.to_tag()});Winston.active_expander.base[0].click()}else if(Winston.active_expander.current_length>1){Winston.sel_mode=2}else{console.log("Empty target! Wtf, bro??");return}}if(Winston.sel_mode==2){var e=Winston.active_expander.to_tag();WinstonSocket.sendEvent({action:"AssertCount",target:e,value:$(e).length})}Winston.sel_mode=0;Winston.destroyCurrentExpander()},processMessage:function(e,t){var n=document.getElementById("winston_message_display");if(n!=undefined)n.innerHTML=t},processUpdate:function(e){if(e.stat=="Running"){Winston.loadAll()}Winston.processMessage("event",e.update)}};var active_engine=Winston;if(rush_those_listeners){Winston.loadPageListeners()}$(document).bind("ready",function(){chrome.extension.onMessage.addListener(function(e,t,n){if(e.swag=="settings"){winston_renders=e.templates;console.log("Templates Loaded");WinstonSocket.sendEvent({action:"Winston",target:"Winston! Leave the fucking cat alone!!"})}if(e.swag=="Stop"||e.stat=="Stopped"){active_engine.processMessage("notify","Stopped!");active_engine.destroyAll()}else if(e.swag=="Start"){active_engine.loadAll();WinstonSocket.sendEvent({action:"Visit",target:window.location.pathname})}else if(e.swag=="Select"){active_engine.startSelectSequence()}else if(e.swag=="update"){active_engine.processUpdate(e)}else{active_engine.processMessage("notify",e)}});WinstonSocket.sendEvent({action:"Winston",target:"load_templates"})})