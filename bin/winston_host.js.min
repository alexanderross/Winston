function eventWrapper(e,t){}function loadDefaults(){if(!localStorage["wayne_engine"]){localStorage["wayne_engine"]="RACCOON"}if(!localStorage["wayne_position"]){localStorage["wayne_position"]="0-1-1-0"}if(!localStorage["wayne_technical"]){localStorage["wayne_technical"]=1}if(!localStorage["wayne_selector"]){localStorage["wayne_selector"]="css"}if(!localStorage["wayne_required"]){localStorage["wayne_required"]=""}if(!localStorage["wayne_deny"]){localStorage["wayne_deny"]=""}if(!localStorage["wayne_index_behaviour"]){localStorage["wayne_index_behaviour"]="0"}if(!localStorage["wayne_wait"]){localStorage["wayne_wait"]="1"}if(!localStorage["wayne_allow_label_click"]){localStorage["wayne_allow_label_click"]="1"}if(!localStorage["wayne_do_saved"]){localStorage["wayne_do_saved"]="y"}}function getStorageUsed(){return(localStorage["wayne_saved"].length/25e5*100).toFixed(2)}function addToSavedCaps(){today=new Date;storedData=JSON.parse(localStorage["wayne_saved"]);storedData.push({date:today.getFullYear()+"/"+today.getMonth()+1+"/"+today.getDate(),time:today.getHours()+":"+today.getMinutes(),data:actions});localStorage["wayne_saved"]=JSON.stringify(storedData)}function start(){actions=new Array;chrome.contextMenus.create({title:"Assert Element Count",contexts:["page"],id:"wayne--elct",onclick:function(e,t){sendMessage({swag:"Select"})}});chrome.contextMenus.create({title:"Assert Selection Exists",contexts:["selection"],id:"wayne--selex",onclick:function(e,t){addEvent(translateEvent({action:"AssertText",target:e.selectionText}));updateNode()}});wayneStarted=true}function stop(){wayneStarted=false;copyToClipboard();if(actions.length){}else{alert(actions.length+" Test items copied to clipboard."+(localStorage["wayne_do_saved"]=="y"?"Save storage "+getStorageUsed()+"% full.":""))}chrome.contextMenus.remove("wayne--elct");chrome.contextMenus.remove("wayne--selex")}function updateNode(){localStorage["wayne_required"]=localStorage["wayne_required"].replace(/ /g,"");sendMessage({swag:"update",stat:wayneStarted?"Running":"Stopped",update:getLastMsg(),count:actions.length,recount:undidactions.length,position:localStorage["wayne_position"],allow_index:localStorage["wayne_index_behaviour"],selectors:localStorage["wayne_required"],bad_selectors:localStorage["wayne_deny"],labelclicks:localStorage["wayne_allow_label_click"]})}function isRepeat(e){if(lastRecieved){if(e==lastRecieved){return true}}return false}function msgToEnglish(e){return e.action+" -> "+e.target}function getLastMsg(){if(actions.length>0){if(localStorage["wayne_technical"]==1){return actions[actions.length-1][1]}else{return actions[actions.length-1][0]}}}function fetchTemplate(e){return document.getElementById("template_"+e).innerHTML}function getTemplates(){return{main:fetchTemplate("main"),expander:fetchTemplate("expander"),expander_attr:fetchTemplate("expander_attr"),expander_attr_comp:fetchTemplate("expander_attr_comp")}}function getSettingsHash(){return{swag:"settings",templates:getTemplates()}}function addEvent(e){if(e){if(e!=""){actions.push(e);undidactions=new Array}}}function addRedoEvent(){redoEvent=undidactions.pop();if(redoEvent){if(redoEvent!=""){actions.push(redoEvent);lastRecieved=redoEvent}}}function translateEvent(e){keyword=localStorage["wayne_selector"];if(outputVerbage=="CAPY"){if(e.action=="Visit"){return["Visit Page",'visit("'+e.target+'")']}else if(e.action=="HTMLClick"){return['Click on "'+e.target.trim()+'"','click_link("'+e.target.trim()+'")']}else if(e.action=="AssertText"){return['Page has "'+e.target+'"?','assert page.has_content?("'+e.target+'")']}else if(e.action=="FieldBlur"){return["Fill in "+e.target+' with "'+e.value+'"','fill_in("'+e.target+'", :with => "'+e.value+'")']}else if(e.action=="FileUpload"){return["Attach File",'attach_file("'+e.target+'", "'+e.value+'")']}else if(e.action=="CheckboxCheck"){return['Check "'+e.target+'"','check("'+e.target+'")']}else if(e.action=="CheckboxUnCheck"){return['Uncheck "'+e.target+'"','uncheck("'+e.target+'")']}else if(e.action=="SelectChange"){return['Select "'+e.value+'" from '+e.target,'select("'+e.value+'", :from => "'+e.target+'")']}else if(e.action=="SubmitClick"){return['Click on "'+e.value+'" button','click_button("'+e.value+'")']}else{e.target=translateSelector(e.target);if(e.action=="AssertText"){return['Assert "'+e.target+'" on page','assert page.has_content?("'+e.target+'")']}else if(e.action=="AssertUrl"){}else if(e.action=="AssertCount"){return["Assert "+e.value+' of "'+e.target+'"',"assert page.has_"+keyword+'?("'+e.target+'",:count => "'+e.value+'")']}else if(e.action=="AssertSingleElement"){return["Assert page has "+e.target,'assert page.has_css?("'+e.target+'")']}else if(e.action=="AJAXEvent"&amp;&amp;localStorage["wayne_wait"]=="1"){return["Wait","sleep(1)"]}else if(e.action=="ElementClick"){if(localStorage["wayne_selector"]=="xpath"){return["Click "+e.target,'find(:xpath,"'+e.target+'").click']}else{return["Click "+e.target,'find("'+e.target+'").click']}}else{return""}}}}function translateSelector(e){if(localStorage["wayne_selector"]=="xpath"){return convertCSSToXPath(e)}else{return e}}function convertCSSToXPath(e){var t="";var e=" "+e;var n=e.split(/([.:#\[ ])/);var r="";var s=-1;for(i=0;i<n.length;i++){if(n[i]==" "){i++;if(t!=""){t+="/"}if(r!=""){t+=r;r=""}r+=n[i]}if(n[i]=="."){if(n[i+1].indexOf(" ")!==-1){r+='[contains(@class,"'+n[i+1]+'")]'}else{r+='[@class="'+n[i+1];while(i+2<n.length&amp;&amp;n[i+2]=="."){i+=2;r+=" "+n[i+1]}r+='"]';i++}}if(n[i]=="#"){i++;r+='[@id = "'+n[i]+'"]'}if(n[i]==":"){i++;n[i]=n[i].replace("eq(","");if(i==n.length-1){s=parseInt(n[i].replace(")",""))+1}else{r+="["+(parseInt(n[i].replace(")",""))+1)+"]"}}if(n[i]=="["){i++;n[i]=n[i].replace("]","");r+="[@"+n[i]+"]"}}if(s!=-1){t="(//"+t+")["+s+"]"}else{if(t!=""){t+="/"}if(r!=""){t+=r}t="//"+t}return t}function cleanAcions(){for(i=0;i<actions.length;i++){actions[i][1]=actions[i][1].replace(/"/g,'"')}}function getPureActionArray(e){newArray=new Array;for(i=0;i<actions.length;i++){newArray.push(actions[i][e])}return newArray}function copyToClipboard(){if(localStorage["wayne_do_saved"]=="y"){addToSavedCaps()}var e=document.createElement("div");e.contentEditable=true;document.body.appendChild(e);e.innerHTML=getPureActionArray(1).join("<br/>");e.unselectable="off";e.focus();document.execCommand("SelectAll");document.execCommand("Copy",false,null);document.body.removeChild(e)}function sendMessage(e){chrome.tabs.getSelected(null,function(t){chrome.tabs.sendMessage(t.id,e)})}function inject(){if(wayneStarted){stop();sendMessage({swag:"Stop"})}else{start();sendMessage({swag:"Start",position:localStorage["wayne_position"]})}}var wayneStarted=false;var lastRecieved=null;var actions=new Array;var undidactions=new Array;var outputVerbage="CAPY";localStorage["wayne_version_number"]="0.989";loadDefaults();if(!localStorage["wayne_saved"]){localStorage["wayne_saved"]="[]"}chrome.extension.onMessage.addListener(function(e,t,n){if(e.action=="Winston"){if(e.target=="load_templates")sendMessage(getSettingsHash());return}if(e.action=="Wayne"){if(e.target=="setevents"){actions=e.values}if(e.target=="undo"){if(actions.length>0){undidactions.push(actions.pop());lastRecieved=actions[actions.length-1]}}else if(e.target=="redo"){addRedoEvent()}else if(e.target=="kill"){wayneStarted=false;sendMessage({swag:"Stop"});stop()}}else if(wayneStarted){if(e.action=="Options"){updateNode()}processed=translateEvent(e);if(!isRepeat(processed)&amp;&amp;processed!=""){lastRecieved=processed;addEvent(processed)}}updateNode()});chrome.browserAction.onClicked.addListener(function(e){inject()})